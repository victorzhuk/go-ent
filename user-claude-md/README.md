# Claude Code Configuration Hierarchy

## File Locations & Priority

Claude Code loads configuration from multiple sources. **More specific rules take precedence**:

```
1. Project CLAUDE.md     (./CLAUDE.md)           ← Highest priority
2. Project settings      (./.claude/settings.json)
3. Plugin skills/agents  (from installed plugins)
4. User CLAUDE.md        (~/.claude/CLAUDE.md)   
5. User settings         (~/.claude/settings.json)
6. Claude defaults                               ← Lowest priority
```

## What Goes Where

### User CLAUDE.md (`~/.claude/CLAUDE.md`)

Personal preferences that apply to ALL projects:

```markdown
# Personal Preferences

## About Me
- Role, experience level
- Communication preferences

## Defaults (when no project rules)
- Coding style
- Naming conventions
- Response format

## Don't
- Things you never want
```

**DO include:**
- Personal context (experience, preferences)
- Default conventions when no project rules exist
- Communication style
- Tools/environment info

**DON'T include:**
- Project-specific rules
- Absolute rules that might conflict with projects
- Domain-specific patterns (use plugins)

### Project CLAUDE.md (`./CLAUDE.md`)

Project-specific rules that override user preferences:

```markdown
# Project Name

## Architecture
- Layer rules
- Dependencies

## Conventions
- Naming
- Error handling
- File structure

## Commands
- make lint
- make test
```

**DO include:**
- Project architecture
- Team conventions
- Build commands
- Project-specific patterns

### Plugin Skills

Domain expertise that complements both:

- `go-review` - Go code review patterns
- `go-patterns` - Go implementation patterns
- `go-testing` - Testing patterns
- `go-architecture` - Architecture patterns

Skills are **additive** - they provide expertise without overriding rules.

## Installation

### User CLAUDE.md

```bash
# Create user config directory
mkdir -p ~/.claude

# Copy the template
cp user-claude-md/CLAUDE.md ~/.claude/CLAUDE.md

# Edit with your preferences
$EDITOR ~/.claude/CLAUDE.md
```

### Project CLAUDE.md

Generated by `/go-ent:init` or copy from templates:

```bash
# In your project directory
cp /path/to/templates/CLAUDE.md.tmpl ./CLAUDE.md
# Edit project-specific values
```

## Example: How Rules Combine

**User CLAUDE.md:**
```markdown
## Defaults
- Short variable names: cfg, repo, srv
```

**Project CLAUDE.md:**
```markdown
## Naming
- Use descriptive names for exported functions
- Short names OK for local variables
```

**Plugin Skill (go-patterns):**
```markdown
## Repository Pattern
- Constructor returns interface: `func New() Repository`
```

**Result:** Claude uses:
- Project rule for exported functions (project overrides user)
- User rule for local variables (no project conflict)
- Plugin pattern for repository implementation (additive expertise)

## Best Practices

1. **User file**: Keep generic, avoid absolutes
2. **Project file**: Be specific, document team conventions
3. **Plugins**: Use for domain expertise
4. **Conflicts**: Project > User > Plugin defaults

## Troubleshooting

**Rules not applying?**
- Check file location (`~/.claude/CLAUDE.md` vs `./CLAUDE.md`)
- Verify no syntax errors
- Project rules override user rules

**Too verbose responses?**
Add to user CLAUDE.md:
```markdown
## Communication
- Be concise
- Skip obvious explanations
```

**Wrong patterns used?**
Check if project CLAUDE.md exists and has architecture section.
